{"ast":null,"code":"var _jsxFileName = \"/Users/anoukpaap/Desktop/opdracht-novi/src/context/AuthContext--test.js\",\n    _s = $RefreshSig$();\n\nimport React, { createContext, useEffect, useState } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\n\nfunction AuthContextProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [Auth, toggleAuth] = useState({\n    isAuth: false,\n    user: null,\n    status: 'pending'\n  });\n  const history = useHistory();\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    console.log(token);\n\n    if (token) {\n      async function getUserData() {\n        try {\n          const response = await axios.get(`https://frontend-educational-backend.herokuapp.com/api/user/`, {\n            headers: {\n              \"Content-Type\": \"application/json\",\n              \"Authorization\": `Bearer ${token}`\n            }\n          });\n          console.log(response.data);\n          toggleAuth({\n            isAuth: true,\n            status: \"done\",\n            user: {\n              email: response.data.email,\n              username: response.data.username,\n              id: response.data.id,\n              roles: response.data.roles[0]\n            }\n          });\n        } catch (e) {\n          toggleAuth({ ...Auth,\n            status: 'error'\n          });\n          localStorage.clear();\n          console.error(e);\n        }\n      }\n\n      getUserData();\n    } else {\n      toggleAuth({ ...Auth,\n        status: 'done'\n      });\n    }\n  }, []);\n\n  function inlog(token) {\n    console.log(\"de user is ingelogd\");\n    const decodedToken = jwt_decode(token);\n    const userId = decodedToken.sub;\n    localStorage.setItem('token', token);\n    toggleAuth({ ...Auth,\n      isAuth: true,\n      status: 'done',\n      user: {\n        username: userId\n      }\n    });\n    history.push(\"/\");\n  }\n\n  function uitlog() {\n    toggleAuth({\n      isAuth: false,\n      user: null,\n      status: 'done'\n    });\n    localStorage.clear();\n    history.push('/');\n  }\n\n  const contextData = {\n    loggedIn: Auth.isAuth,\n    login: inlog,\n    logout: uitlog,\n    user: Auth.user\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextData,\n    children: [Auth.status === \"done\" && children, Auth.status === \"pending\" && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading..\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 47\n    }, this), Auth.status === \"error\" && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Er is iets is mis gegaan \", /*#__PURE__*/_jsxDEV(\"link\", {\n        to: \"/inlog\",\n        children: \" log je opnieuw in!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 73\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 45\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 13\n  }, this);\n}\n\n_s(AuthContextProvider, \"R5A0SQhfepFkjUyWb4+QrOVdv8Q=\", false, function () {\n  return [useHistory];\n});\n\n_c = AuthContextProvider;\nexport default AuthContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","useHistory","axios","jwt_decode","AuthContext","AuthContextProvider","children","Auth","toggleAuth","isAuth","user","status","history","token","localStorage","getItem","console","log","getUserData","response","get","headers","data","email","username","id","roles","e","clear","error","inlog","decodedToken","userId","sub","setItem","push","uitlog","contextData","loggedIn","login","logout"],"sources":["/Users/anoukpaap/Desktop/opdracht-novi/src/context/AuthContext--test.js"],"sourcesContent":["import React, {createContext, useEffect, useState} from 'react';\nimport {useHistory} from \"react-router-dom\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\n\nexport const AuthContext = createContext({})\n\nfunction AuthContextProvider({children}) {\n    const [Auth, toggleAuth] = useState({\n        isAuth: false,\n        user: null,\n        status: 'pending',\n    });\n    const history = useHistory();\n\n    useEffect(() => {\n        const token = localStorage.getItem(\"token\");\n        console.log(token)\n\n        if (token) {\n            async function getUserData() {\n                try {\n                    const response = await axios.get(`https://frontend-educational-backend.herokuapp.com/api/user/`, {\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            \"Authorization\": `Bearer ${token}`,\n                        }\n                    });\n                    console.log(response.data);\n                    toggleAuth({\n                        isAuth: true,\n                        status: \"done\",\n                        user:{email: response.data.email,\n                            username:response.data.username,\n                            id: response.data.id,\n                            roles: response.data.roles[0],\n                        }\n                    })\n                } catch (e) {\n                    toggleAuth({\n                       ...Auth,\n                        status: 'error'\n                    })\n                    localStorage.clear()\n                    console.error(e);\n                }\n\n            }\n            getUserData();}\n        else\n            {\n                toggleAuth({\n                    ...Auth,\n                    status: 'done'\n                })\n            }\n\n        },[]);\n\n\n        function inlog(token) {\n            console.log(\"de user is ingelogd\")\n            const decodedToken = jwt_decode(token);\n            const userId = decodedToken.sub;\n            localStorage.setItem('token', token)\n\n            toggleAuth({\n                ...Auth,\n                isAuth: true,\n                status: 'done',\n                user: {\n                    username: userId,\n                }\n            });\n            history.push(\"/\")\n        }\n\n\n        function uitlog() {\n            toggleAuth({\n                isAuth: false,\n                user: null,\n                status: 'done'\n            })\n            localStorage.clear()\n            history.push('/')\n        }\n\n        const contextData = {\n            loggedIn: Auth.isAuth,\n            login: inlog,\n            logout: uitlog,\n            user: Auth.user,\n        }\n\n        return (\n            <AuthContext.Provider value={contextData}>\n                {Auth.status === \"done\" && children}\n                {Auth.status === \"pending\" && <p>Loading..</p>}\n                {Auth.status === \"error\" && <p>Er is iets is mis gegaan <link to=\"/inlog\"> log je opnieuw in!</link></p> }\n            </AuthContext.Provider>\n        )\n    }\n\n    export default AuthContextProvider"],"mappings":"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"},"metadata":{},"sourceType":"module"}