{"ast":null,"code":"var _jsxFileName = \"/Users/anoukpaap/Desktop/opdracht-novi/src/context/AuthContext--test.js\",\n    _s = $RefreshSig$();\n\nimport React, { createContext, useEffect, useState } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\n\nfunction AuthContextProvider(_ref) {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [Auth, toggleAuth] = useState({\n    isAuth: false,\n    user: null,\n    status: 'pending'\n  });\n  const history = useHistory();\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    console.log(token);\n\n    if (token) {\n      async function getUserData() {\n        try {\n          const response = await axios.get(`https://frontend-educational-backend.herokuapp.com/api/user/`, {\n            headers: {\n              \"Content-Type\": \"application/json\",\n              \"Authorization\": `Bearer ${token}`\n            }\n          });\n          console.log(response.data);\n          toggleAuth({\n            isAuth: true,\n            user: {\n              email: response.data.email,\n              username: response.data.username,\n              id: response.data.id,\n              roles: response.data.roles[0]\n            }\n          });\n        } catch (e) {\n          console.error(e);\n        }\n      }\n\n      getUserData();\n    } else {}\n  }, []);\n\n  function inlog(token) {\n    console.log(\"de user is ingelogd\");\n    const decodedToken = jwt_decode(token);\n    const userId = decodedToken.sub;\n    localStorage.setItem('token', token);\n    toggleAuth({ ...auth,\n      isAuth: true,\n      status: 'done',\n      user: {\n        username: userId // email: data.data.email,\n        // id: data.data.id,\n\n      }\n    });\n    history.push(\"/\"); //     if (redirectUrl) {\n    //         history.push(redirectUrl)\n    //     }\n    // } catch (e) {\n    //     console.error(e)\n    // }\n  }\n\n  function uitlog() {\n    toggleAuth({\n      isAuth: false,\n      user: null,\n      status: 'done'\n    });\n    localStorage.clear();\n    history.push('/');\n  }\n\n  const contextData = {\n    loggedIn: Auth.isAuth,\n    login: inlog,\n    logout: uitlog,\n    user: Auth.user\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextData,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 13\n  }, this);\n}\n\n_s(AuthContextProvider, \"R5A0SQhfepFkjUyWb4+QrOVdv8Q=\", false, function () {\n  return [useHistory];\n});\n\n_c = AuthContextProvider;\nexport default AuthContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","useHistory","axios","jwt_decode","AuthContext","AuthContextProvider","children","Auth","toggleAuth","isAuth","user","status","history","token","localStorage","getItem","console","log","getUserData","response","get","headers","data","email","username","id","roles","e","error","inlog","decodedToken","userId","sub","setItem","auth","push","uitlog","clear","contextData","loggedIn","login","logout"],"sources":["/Users/anoukpaap/Desktop/opdracht-novi/src/context/AuthContext--test.js"],"sourcesContent":["import React, {createContext, useEffect, useState} from 'react';\nimport {useHistory} from \"react-router-dom\";\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\n\nexport const AuthContext = createContext({})\n\nfunction AuthContextProvider({children}) {\n    const [Auth, toggleAuth] = useState({\n        isAuth: false,\n        user: null,\n        status: 'pending',\n    });\n    const history = useHistory();\n\n    useEffect(() => {\n        const token = localStorage.getItem(\"token\");\n        console.log(token)\n\n        if (token) {\n            async function getUserData() {\n                try {\n                    const response = await axios.get(`https://frontend-educational-backend.herokuapp.com/api/user/`, {\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            \"Authorization\": `Bearer ${token}`,\n                        }\n                    });\n                    console.log(response.data);\n                    toggleAuth({\n                        isAuth: true,\n                        user:{email: response.data.email,\n                            username:response.data.username,\n                            id: response.data.id,\n                            roles: response.data.roles[0],\n                        }\n                    })\n                } catch (e) {\n                    console.error(e);\n                }\n\n            }\n            getUserData();}\n        else\n            {\n            }\n\n        },[]);\n\n\n        function inlog(token) {\n            console.log(\"de user is ingelogd\")\n            const decodedToken = jwt_decode(token);\n            const userId = decodedToken.sub;\n            localStorage.setItem('token', token)\n\n            toggleAuth({\n                ...auth,\n                isAuth: true,\n                status: 'done',\n                user: {\n                    username: userId,\n                    // email: data.data.email,\n                    // id: data.data.id,\n                }\n            });\n            history.push(\"/\")\n            //     if (redirectUrl) {\n            //         history.push(redirectUrl)\n            //     }\n            // } catch (e) {\n            //     console.error(e)\n            // }\n        }\n\n\n        function uitlog() {\n            toggleAuth({\n                isAuth: false,\n                user: null,\n                status: 'done'\n            })\n            localStorage.clear()\n            history.push('/')\n        }\n\n        const contextData = {\n            loggedIn: Auth.isAuth,\n            login: inlog,\n            logout: uitlog,\n            user: Auth.user,\n        }\n\n        return (\n            <AuthContext.Provider value={contextData}>\n                {children}\n            </AuthContext.Provider>\n        )\n    }\n\n    export default AuthContextProvider"],"mappings":"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"},"metadata":{},"sourceType":"module"}